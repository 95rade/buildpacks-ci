# encoding: utf-8
# require 'rss'
require 'nokogiri'
require 'open-uri'
class BuildpackCVETags
  def initialize(language)
    @language = language
  end

  def related_cves
    return [] unless feed
    ul = feed.css("ul")
    list = ul[0].css('li > a')
    list.map do |li|
      {
        title: li.text,
        description: 'http://www.ruby-lang.org' + li['href']
      }
    end
  end

  private

  def feed_uri
    'http://www.ruby-lang.org/en/security'
  end

  def feed
    @feed ||= Nokogiri::HTML(open(feed_uri))
  end
end
