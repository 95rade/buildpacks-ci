---
resources:
  - name: php-buildpack
    type: git
    source:
      uri: https://github.com/cloudfoundry/php-buildpack
      branch: develop
  - name: php-buildpack-master
    type: git
    source:
      uri: git@github.com:cloudfoundry/php-buildpack.git
      private_key: {{buildpacks-private-key}}
      branch: master
  - name: binary-buildpack
    type: git
    source:
      uri: https://github.com/cloudfoundry/binary-buildpack
      branch: develop
  - name: binary-buildpack-master
    type: git
    source:
      uri: git@github.com:cloudfoundry/binary-buildpack.git
      private_key: {{buildpacks-private-key}}
      branch: master
  - name: staticfile-buildpack
    type: git
    source:
      uri: https://github.com/cloudfoundry/staticfile-buildpack
      branch: develop
  - name: staticfile-buildpack-master
    type: git
    source:
      uri: git@github.com:cloudfoundry/staticfile-buildpack.git
      private_key: {{buildpacks-private-key}}
      branch: master
  - name: python-buildpack
    type: git
    source:
      uri: https://github.com/cloudfoundry/python-buildpack
      branch: develop
  - name: python-buildpack-master
    type: git
    source:
      uri: git@github.com:cloudfoundry/python-buildpack.git
      private_key: {{buildpacks-private-key}}
      branch: master
  - name: nodejs-buildpack
    type: git
    source:
      uri: https://github.com/cloudfoundry/nodejs-buildpack
      branch: develop
  - name: nodejs-buildpack-master
    type: git
    source:
      uri: git@github.com:cloudfoundry/nodejs-buildpack.git
      private_key: {{buildpacks-private-key}}
      branch: master
  - name: ruby-buildpack
    type: git
    source:
      uri: https://github.com/cloudfoundry/ruby-buildpack
      branch: develop
  - name: ruby-buildpack-master
    type: git
    source:
      uri: git@github.com:cloudfoundry/ruby-buildpack.git
      private_key: {{buildpacks-private-key}}
      branch: master
  - name: go-buildpack
    type: git
    source:
      uri: https://github.com/cloudfoundry/go-buildpack
      branch: develop
  - name: go-buildpack-master
    type: git
    source:
      uri: git@github.com:cloudfoundry/go-buildpack.git
      private_key: {{buildpacks-private-key}}
      branch: master
  - name: ci-tools
    type: git
    source:
      uri: https://github.com/cloudfoundry/ci-tools
  - name: buildpacks-ci
    type: git
    source:
      uri: git@github.com:pivotal-cf/buildpacks-ci
      private_key: {{buildpacks-private-key}}
  - name: machete-firewall-test
    type: git
    source:
      uri: https://github.com/cf-buildpacks/machete-firewall-test
  - name: deployments-buildpacks
    type: git
    source:
      uri: git@github.com:pivotal-cf/deployments-buildpacks
      private_key: {{buildpacks-private-key}}
  - name: buildpack-packager
    type: git
    source:
      uri: https://github.com/cloudfoundry-incubator/buildpack-packager.git
  - name: machete
    type: git
    source:
      uri: https://github.com/cf-buildpacks/machete.git
  - name: compile-extensions
    type: git
    source:
      uri: https://github.com/cloudfoundry-incubator/compile-extensions.git
  - name: heroku-nanny
    type: git
    source:
      uri: https://github.com/cf-buildpacks/upstream-nanny.git
  - name: brats
    type: git
    source:
      uri: https://github.com/cloudfoundry/brats.git
  - name: ruby-pivotal-buildpack
    type: s3
    source:
      bucket: pivotal-buildpacks
      regexp: ruby_buildpack-v(.*).zip
      access_key_id: {{pivotal-buildpacks-s3-access-key}}
      secret_access_key: {{pivotal-buildpacks-s3-secret-key}}
  - name: nodejs-pivotal-buildpack
    type: s3
    source:
      bucket: pivotal-buildpacks
      regexp: nodejs_buildpack-v(.*).zip
      access_key_id: {{pivotal-buildpacks-s3-access-key}}
      secret_access_key: {{pivotal-buildpacks-s3-secret-key}}
  - name: python-pivotal-buildpack
    type: s3
    source:
      bucket: pivotal-buildpacks
      regexp: python_buildpack-v(.*).zip
      access_key_id: {{pivotal-buildpacks-s3-access-key}}
      secret_access_key: {{pivotal-buildpacks-s3-secret-key}}
  - name: go-pivotal-buildpack
    type: s3
    source:
      bucket: pivotal-buildpacks
      regexp: go_buildpack-v(.*).zip
      access_key_id: {{pivotal-buildpacks-s3-access-key}}
      secret_access_key: {{pivotal-buildpacks-s3-secret-key}}
  - name: php-pivotal-buildpack
    type: s3
    source:
      bucket: pivotal-buildpacks
      regexp: php_buildpack-v(.*).zip
      access_key_id: {{pivotal-buildpacks-s3-access-key}}
      secret_access_key: {{pivotal-buildpacks-s3-secret-key}}
  - name: staticfile-pivotal-buildpack
    type: s3
    source:
      bucket: pivotal-buildpacks
      regexp: staticfile_buildpack-v(.*).zip
      access_key_id: {{pivotal-buildpacks-s3-access-key}}
      secret_access_key: {{pivotal-buildpacks-s3-secret-key}}
  - name: binary-pivotal-buildpack
    type: s3
    source:
      bucket: pivotal-buildpacks
      regexp: binary_buildpack-v(.*).zip
      access_key_id: {{pivotal-buildpacks-s3-access-key}}
      secret_access_key: {{pivotal-buildpacks-s3-secret-key}}
  - name: ruby-pivotal-buildpack-cached
    type: s3
    source:
      bucket: pivotal-buildpacks
      regexp: ruby_buildpack-cached-v(.*).zip
      access_key_id: {{pivotal-buildpacks-s3-access-key}}
      secret_access_key: {{pivotal-buildpacks-s3-secret-key}}
  - name: nodejs-pivotal-buildpack-cached
    type: s3
    source:
      bucket: pivotal-buildpacks
      regexp: nodejs_buildpack-cached-v(.*).zip
      access_key_id: {{pivotal-buildpacks-s3-access-key}}
      secret_access_key: {{pivotal-buildpacks-s3-secret-key}}
  - name: python-pivotal-buildpack-cached
    type: s3
    source:
      bucket: pivotal-buildpacks
      regexp: python_buildpack-cached-v(.*).zip
      access_key_id: {{pivotal-buildpacks-s3-access-key}}
      secret_access_key: {{pivotal-buildpacks-s3-secret-key}}
  - name: go-pivotal-buildpack-cached
    type: s3
    source:
      bucket: pivotal-buildpacks
      regexp: go_buildpack-cached-v(.*).zip
      access_key_id: {{pivotal-buildpacks-s3-access-key}}
      secret_access_key: {{pivotal-buildpacks-s3-secret-key}}
  - name: php-pivotal-buildpack-cached
    type: s3
    source:
      bucket: pivotal-buildpacks
      regexp: php_buildpack-cached-v(.*).zip
      access_key_id: {{pivotal-buildpacks-s3-access-key}}
      secret_access_key: {{pivotal-buildpacks-s3-secret-key}}
  - name: staticfile-pivotal-buildpack-cached
    type: s3
    source:
      bucket: pivotal-buildpacks
      regexp: staticfile_buildpack-cached-v(.*).zip
      access_key_id: {{pivotal-buildpacks-s3-access-key}}
      secret_access_key: {{pivotal-buildpacks-s3-secret-key}}
  - name: binary-pivotal-buildpack-cached
    type: s3
    source:
      bucket: pivotal-buildpacks
      regexp: binary_buildpack-cached-v(.*).zip
      access_key_id: {{pivotal-buildpacks-s3-access-key}}
      secret_access_key: {{pivotal-buildpacks-s3-secret-key}}
  - name: cf-release
    type: git
    source:
      uri: https://github.com/cf-buildpacks/cf-release
  - name: brats-time-resource
    type: time
    source:
      interval: 12h
      start: 19:00 -0400
      stop: 00:00 -0400
groups:
- name: binary-buildpack
  jobs:
  - binary-buildpack-CF-edge
  - binary-buildpack-CF-LTS
  - binary buildpack to cf-release
  - binary buildpack to pivnet
  - binary buildpack to github
  - binary-buildpack-release
  - binary-buildpack-CF-edge-master
  - binary-buildpack-CF-LTS-master
  - detect new Binary buildpack and upload artifacts
- name: staticfile-buildpack
  jobs:
  - staticfile-buildpack-CF-edge
  - staticfile-buildpack-CF-LTS
  - staticfile buildpack to cf-release
  - staticfile buildpack to pivnet
  - staticfile buildpack to github
  - staticfile-buildpack-release
  - staticfile-buildpack-CF-edge-master
  - staticfile-buildpack-CF-LTS-master
  - detect new Staticfile buildpack and upload artifacts
- name: php-buildpack
  jobs:
  - php-buildpack-CF-edge
  - php-buildpack-CF-LTS
  - php buildpack to cf-release
  - php buildpack to pivnet
  - php buildpack to github
  - php-buildpack-release
  - php-buildpack-CF-edge-master
  - php-buildpack-CF-LTS-master
  - detect new PHP buildpack and upload artifacts
- name: python-buildpack
  jobs:
  - python-buildpack-CF-edge
  - python-buildpack-CF-LTS
  - python buildpack to cf-release
  - python buildpack to pivnet
  - python buildpack to github
  - python-buildpack-release
  - python-buildpack-CF-edge-master
  - python-buildpack-CF-LTS-master
  - detect new Python buildpack and upload artifacts
- name: nodejs-buildpack
  jobs:
  - nodejs-buildpack-CF-edge
  - nodejs-buildpack-CF-LTS
  - nodejs buildpack to cf-release
  - nodejs buildpack to pivnet
  - nodejs buildpack to github
  - nodejs-buildpack-release
  - nodejs-buildpack-CF-edge-master
  - nodejs-buildpack-CF-LTS-master
  - detect new NodeJS buildpack and upload artifacts
- name: go-buildpack
  jobs:
  - go-buildpack-CF-edge
  - go-buildpack-CF-LTS
  - go buildpack to cf-release
  - go buildpack to pivnet
  - go buildpack to github
  - go-buildpack-release
  - go-buildpack-CF-edge-master
  - go-buildpack-CF-LTS-master
  - detect new Go buildpack and upload artifacts
- name: ruby-buildpack
  jobs:
  - ruby-buildpack-CF-edge
  - ruby-buildpack-CF-LTS
  - ruby buildpack to cf-release
  - ruby buildpack to pivnet
  - ruby buildpack to github
  - ruby-buildpack-release
  - ruby-buildpack-CF-edge-master
  - ruby-buildpack-CF-LTS-master
  - detect new Ruby buildpack and upload artifacts
- name: tooling
  jobs:
  - buildpack-packager
  - machete
  - compile-extensions
  - old-releases
  - heroku-nanny
  - machete-firewall-CF-edge
  - machete-firewall-CF-LTS
- name: brats
  jobs:
  - brats-go-CF-LTS
  - brats-go-CF-edge
  - brats-python-CF-LTS
  - brats-python-CF-edge
  - brats-nodejs-CF-LTS
  - brats-nodejs-CF-edge
  - brats-php-CF-LTS
  - brats-php-CF-edge
  - brats-ruby-CF-LTS
  - brats-ruby-CF-edge
jobs:
  - name: binary-buildpack-CF-edge
    serial: true
    serial_groups: [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: binary-buildpack
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: ci-tools
            - name: binary-buildpack
            - name: deployments-buildpacks
          run:
            path: buildpacks-ci/scripts/binary-buildpack.sh
          params:
            DEPLOYMENT_NAME: bp-ci-8
            STACKS: lucid64 cflinuxfs2
        privileged: true
  - name: binary-buildpack-CF-LTS
    serial: true
    serial_groups: [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: binary-buildpack
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: ci-tools
            - name: binary-buildpack
            - name: deployments-buildpacks
          run:
            path: buildpacks-ci/scripts/binary-buildpack.sh
          params:
            DEPLOYMENT_NAME: bp-ci-7
            STACKS: lucid64
        privileged: true
  - name: staticfile-buildpack-CF-edge
    serial: true
    serial_groups: [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: staticfile-buildpack
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: ci-tools
            - name: staticfile-buildpack
            - name: deployments-buildpacks
          run:
            path: buildpacks-ci/scripts/staticfile-buildpack.sh
          params:
            DEPLOYMENT_NAME: bp-ci-8
            STACKS: lucid64 cflinuxfs2
        privileged: true
  - name: staticfile-buildpack-CF-LTS
    serial: true
    serial_groups: [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: staticfile-buildpack
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: ci-tools
            - name: staticfile-buildpack
            - name: deployments-buildpacks
          run:
            path: buildpacks-ci/scripts/staticfile-buildpack.sh
          params:
            DEPLOYMENT_NAME: bp-ci-7
            STACKS: lucid64
        privileged: true
  - name: php-buildpack-CF-edge
    serial: true
    serial_groups: [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: php-buildpack
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: ci-tools
            - name: php-buildpack
            - name: deployments-buildpacks
          run:
            path: buildpacks-ci/scripts/php-buildpack.sh
          params:
            DEPLOYMENT_NAME: bp-ci-8
            STACKS: lucid64 cflinuxfs2
            COMPOSER_GITHUB_OAUTH_TOKEN: {{composer-github-oauth-token}}
        privileged: true
  - name: php-buildpack-CF-LTS
    serial: true
    serial_groups: [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: php-buildpack
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: ci-tools
            - name: php-buildpack
            - name: deployments-buildpacks
          run:
            path: buildpacks-ci/scripts/php-buildpack.sh
          params:
            DEPLOYMENT_NAME: bp-ci-7
            STACKS: lucid64
            COMPOSER_GITHUB_OAUTH_TOKEN: {{composer-github-oauth-token}}
        privileged: true
  - name: python-buildpack-CF-edge
    serial: true
    serial_groups: [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: python-buildpack
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: ci-tools
            - name: python-buildpack
            - name: deployments-buildpacks
          run:
            path: buildpacks-ci/scripts/python-buildpack.sh
          params:
            DEPLOYMENT_NAME: bp-ci-8
            STACKS: lucid64 cflinuxfs2
        privileged: true
  - name: python-buildpack-CF-LTS
    serial: true
    serial_groups: [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: python-buildpack
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: ci-tools
            - name: python-buildpack
            - name: deployments-buildpacks
          run:
            path: buildpacks-ci/scripts/python-buildpack.sh
          params:
            DEPLOYMENT_NAME: bp-ci-7
            STACKS: lucid64
        privileged: true
  - name: nodejs-buildpack-CF-edge
    serial: true
    serial_groups: [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: nodejs-buildpack
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: ci-tools
            - name: nodejs-buildpack
            - name: deployments-buildpacks
          run:
            path: buildpacks-ci/scripts/nodejs-buildpack.sh
          params:
            DEPLOYMENT_NAME: bp-ci-8
            STACKS: lucid64 cflinuxfs2
        privileged: true
  - name: nodejs-buildpack-CF-LTS
    serial: true
    serial_groups: [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: nodejs-buildpack
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: ci-tools
            - name: nodejs-buildpack
            - name: deployments-buildpacks
          run:
            path: buildpacks-ci/scripts/nodejs-buildpack.sh
          params:
            DEPLOYMENT_NAME: bp-ci-7
            STACKS: lucid64
        privileged: true
  - name: ruby-buildpack-CF-edge
    serial: true
    serial_groups: [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: ruby-buildpack
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: ci-tools
            - name: ruby-buildpack
            - name: deployments-buildpacks
          run:
            path: buildpacks-ci/scripts/ruby-buildpack.sh
          params:
            DEPLOYMENT_NAME: bp-ci-8
            STACKS: lucid64 cflinuxfs2
        privileged: true
  - name: ruby-buildpack-CF-LTS
    serial: true
    serial_groups: [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: ruby-buildpack
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: ci-tools
            - name: ruby-buildpack
            - name: deployments-buildpacks
          run:
            path: buildpacks-ci/scripts/ruby-buildpack.sh
          params:
            DEPLOYMENT_NAME: bp-ci-7
            STACKS: lucid64
        privileged: true
  - name: go-buildpack-CF-edge
    serial: true
    serial_groups: [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: go-buildpack
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: ci-tools
            - name: go-buildpack
            - name: deployments-buildpacks
          run:
            path: buildpacks-ci/scripts/go-buildpack.sh
          params:
            DEPLOYMENT_NAME: bp-ci-8
            STACKS: lucid64 cflinuxfs2
        privileged: true
  - name: go-buildpack-CF-LTS
    serial: true
    serial_groups: [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: go-buildpack
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: ci-tools
            - name: go-buildpack
            - name: deployments-buildpacks
          run:
            path: buildpacks-ci/scripts/go-buildpack.sh
          params:
            DEPLOYMENT_NAME: bp-ci-7
            STACKS: lucid64
        privileged: true
  - name: machete-firewall-CF-edge
    serial: true
    serial_groups: [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: machete-firewall-test
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: ci-tools
            - name: deployments-buildpacks
            - name: machete-firewall-test
          run:
            path: buildpacks-ci/scripts/machete-firewall.sh
          params:
            DEPLOYMENT_NAME: bp-ci-8
            STACKS: lucid64 cflinuxfs2
        privileged: true
  - name: machete-firewall-CF-LTS
    serial: true
    serial_groups : [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: machete-firewall-test
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: ci-tools
            - name: deployments-buildpacks
            - name: machete-firewall-test
          run:
            path: buildpacks-ci/scripts/machete-firewall.sh
          params:
            DEPLOYMENT_NAME: bp-ci-7
            STACKS: lucid64
        privileged: true
  - name: buildpack-packager
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: buildpack-packager
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: buildpack-packager
          run:
            path: buildpacks-ci/scripts/buildpack-packager.sh
        privileged: true
  - name: machete
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: machete
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: machete
          run:
            path: buildpacks-ci/scripts/machete.sh
        privileged: true
  - name: compile-extensions
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: compile-extensions
          trigger: true
      - task: rspec
        config:
          platform: linux
          image: docker:///ruby#1.9.3-slim
          inputs:
            - name: buildpacks-ci
            - name: compile-extensions
          run:
            path: buildpacks-ci/scripts/compile-extensions.sh
        privileged: true
  - name: old-releases
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
          trigger: true
      - task: outdated_buildpack_releases
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: ci-tools
          run:
            path: buildpacks-ci/scripts/old-releases.sh
          params:
            GITHUB_TOKEN: {{buildpacks-github-token}}
        privileged: true
  - name: heroku-nanny
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: heroku-nanny
          trigger: true
      - task: sanity-check-upstream
        config:
          platform: linux
          image: docker:///cfbuildpacks/ci#buildpack
          inputs:
            - name: buildpacks-ci
            - name: heroku-nanny
          run:
            path: buildpacks-ci/scripts/heroku-nanny.sh
        privileged: true
  - name: brats-go-CF-LTS
    serial: true
    serial_groups : [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: brats
        - get: deployments-buildpacks
        - {get: brats-time-resource, trigger: true}
      - task: bin-tests
        file: buildpacks-ci/tasks/brats.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-7
            LANGUAGE: go
            STACK: lucid64
        privileged: true
  - name: brats-go-CF-edge
    serial: true
    serial_groups : [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: brats
        - get: deployments-buildpacks
        - {get: brats-time-resource, trigger: true}
      - task: bin-tests
        file: buildpacks-ci/tasks/brats.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-8
            LANGUAGE: go
        privileged: true
  - name: brats-python-CF-LTS
    serial: true
    serial_groups : [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: brats
        - get: deployments-buildpacks
        - {get: brats-time-resource, trigger: true}
      - task: bin-tests
        file: buildpacks-ci/tasks/brats.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-7
            LANGUAGE: python
            STACK: lucid64
        privileged: true
  - name: brats-python-CF-edge
    serial: true
    serial_groups : [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: brats
        - get: deployments-buildpacks
        - {get: brats-time-resource, trigger: true}
      - task: bin-tests
        file: buildpacks-ci/tasks/brats.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-8
            LANGUAGE: python
        privileged: true
  - name: brats-nodejs-CF-LTS
    serial: true
    serial_groups : [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: brats
        - get: deployments-buildpacks
        - {get: brats-time-resource, trigger: true}
      - task: bin-tests
        file: buildpacks-ci/tasks/brats.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-7
            LANGUAGE: nodejs
            STACK: lucid64
        privileged: true
  - name: brats-nodejs-CF-edge
    serial: true
    serial_groups : [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: brats
        - get: deployments-buildpacks
        - {get: brats-time-resource, trigger: true}
      - task: bin-tests
        file: buildpacks-ci/tasks/brats.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-8
            LANGUAGE: nodejs
        privileged: true
  - name: brats-php-CF-LTS
    serial: true
    serial_groups : [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: brats
        - get: deployments-buildpacks
        - {get: brats-time-resource, trigger: true}
      - task: bin-tests
        file: buildpacks-ci/tasks/brats.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-7
            LANGUAGE: php
            STACK: lucid64
        privileged: true
  - name: brats-php-CF-edge
    serial: true
    serial_groups : [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: brats
        - get: deployments-buildpacks
        - {get: brats-time-resource, trigger: true}
      - task: bin-tests
        file: buildpacks-ci/tasks/brats.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-8
            LANGUAGE: php
        privileged: true
  - name: brats-ruby-CF-LTS
    serial: true
    serial_groups : [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: brats
        - get: deployments-buildpacks
        - {get: brats-time-resource, trigger: true}
      - task: bin-tests
        file: buildpacks-ci/tasks/brats.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-7
            LANGUAGE: ruby
            STACK: lucid64
        privileged: true
  - name: brats-ruby-CF-edge
    serial: true
    serial_groups : [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: brats
        - get: deployments-buildpacks
        - {get: brats-time-resource, trigger: true}
      - task: bin-tests
        file: buildpacks-ci/tasks/brats.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-8
            LANGUAGE: ruby
        privileged: true
  - name: detect new Ruby buildpack and upload artifacts
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: buildpack
          resource: ruby-buildpack-master
          trigger: true
      - task: detect and upload
        file: buildpacks-ci/tasks/detect-and-upload.yml
        privileged: true
      - put: ruby-pivotal-buildpack
        params:
          from: buildpack/ruby_buildpack-v(.*).zip
          to: /experimental-buildpacks/ruby/
      - put: ruby-pivotal-buildpack-cached
        params:
          from: buildpack/ruby_buildpack-cached-v(.*).zip
          to: /experimental-buildpacks/ruby/
  - name: ruby-buildpack-CF-edge-master
    serial: true
    serial_groups: [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: buildpack
          passed: [ "detect new Ruby buildpack and upload artifacts" ]
          resource: ruby-buildpack-master
          trigger: true
        - get: pivotal-buildpacks
          resource: ruby-pivotal-buildpack
          passed: [ "detect new Ruby buildpack and upload artifacts" ]
          trigger: true
        - get: pivotal-buildpacks-cached
          resource: ruby-pivotal-buildpack-cached
          passed: [ "detect new Ruby buildpack and upload artifacts" ]
          trigger: true
      - task: rspec
        file: buildpacks-ci/tasks/test-buildpack-for-release.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-8
            STACKS: lucid64 cflinuxfs2
        privileged: true
  - name: ruby-buildpack-CF-LTS-master
    serial: true
    serial_groups: [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: buildpack
          passed: [ "detect new Ruby buildpack and upload artifacts" ]
          resource: ruby-buildpack-master
          trigger: true
        - get: pivotal-buildpacks
          resource: ruby-pivotal-buildpack
          passed: [ "detect new Ruby buildpack and upload artifacts" ]
          trigger: true
        - get: pivotal-buildpacks-cached
          resource: ruby-pivotal-buildpack-cached
          passed: [ "detect new Ruby buildpack and upload artifacts" ]
          trigger: true
      - task: rspec
        file: buildpacks-ci/tasks/test-buildpack-for-release.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-7
            STACKS: lucid64
        privileged: true
  - name: ruby-buildpack-release
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: pivotal-buildpacks-cached
          resource: ruby-pivotal-buildpack-cached
          passed: [ "ruby-buildpack-CF-LTS-master", "ruby-buildpack-CF-edge-master" ]
          trigger: true
        - get: buildpack
          passed: [ "ruby-buildpack-CF-LTS-master", "ruby-buildpack-CF-edge-master" ]
          resource: ruby-buildpack-master
          trigger: true
      - task: check tag not already added
        file: buildpacks-ci/tasks/check-tag-not-already-added.yml
      - put: ruby-buildpack-master
        params:
          repository: buildpack
          tag: buildpack/VERSION
          tag_prefix: v
  - name: ruby buildpack to github
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: ruby-pivotal-buildpack-cached
          passed: [ ruby-buildpack-release ]
        - get: buildpack
          resource: ruby-buildpack-master
          passed: [ ruby-buildpack-release ]
      - task: upload to github
        file: buildpacks-ci/tasks/upload-to-github.yml
        config:
          params:
            GITHUB_ORG: cloudfoundry
            GITHUB_TOKEN: {{buildpacks-github-token}}
  - name: ruby buildpack to cf-release
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: ruby-pivotal-buildpack-cached
          passed: [ ruby-buildpack-release ]
        - get: buildpack
          resource: ruby-buildpack-master
          passed: [ ruby-buildpack-release ]
        - get: cf-release
      - task: upload to cf-release
        file: buildpacks-ci/tasks/upload-to-cf-release.yml
        config:
          params:
            ACCESS_KEY_ID: {{blobstore-access-key}}
            SECRET_ACCESS_KEY: {{blobstore-secret-key}}
            GITHUB_USER: {{github-username}}
            GITHUB_PASSWORD: {{github-password}}
        privileged: true
  - name: ruby buildpack to pivnet
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: ruby-pivotal-buildpack-cached
          passed: [ ruby-buildpack-release ]
        - get: buildpack
          resource: ruby-buildpack-master
          passed: [ ruby-buildpack-release ]
      - task: upload to pivnet
        file: buildpacks-ci/tasks/upload-to-pivnet.yml
        config:
          params:
            AWS_ACCESS_KEY_ID: {{pivnet-access-key}}
            AWS_SECRET_ACCESS_KEY: {{pivnet-secret-key}}
            PIVNET_S3_BUCKET: pivnet-acceptance
            PIVNET_ADDRESS: https://network.pivotal.io/
            PIVNET_APIKEY: {{pivnet-apikey}}
            PIVNET_PRODUCT_NAME: Ruby Buildpack (offline)
        privileged: true
  - name: detect new NodeJS buildpack and upload artifacts
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: buildpack
          resource: nodejs-buildpack-master
          trigger: true
      - task: detect and upload
        file: buildpacks-ci/tasks/detect-and-upload.yml
        privileged: true
      - put: nodejs-pivotal-buildpack
        params:
          from: buildpack/nodejs_buildpack-v(.*).zip
          to: /experimental-buildpacks/nodejs/
      - put: nodejs-pivotal-buildpack-cached
        params:
          from: buildpack/nodejs_buildpack-cached-v(.*).zip
          to: /experimental-buildpacks/nodejs/
  - name: nodejs-buildpack-CF-edge-master
    serial: true
    serial_groups: [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: buildpack
          passed: [ "detect new NodeJS buildpack and upload artifacts" ]
          resource: nodejs-buildpack-master
          trigger: true
        - get: pivotal-buildpacks
          resource: nodejs-pivotal-buildpack
          passed: [ "detect new NodeJS buildpack and upload artifacts" ]
          trigger: true
        - get: pivotal-buildpacks-cached
          resource: nodejs-pivotal-buildpack-cached
          passed: [ "detect new NodeJS buildpack and upload artifacts" ]
          trigger: true
      - task: rspec
        file: buildpacks-ci/tasks/test-buildpack-for-release.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-8
            STACKS: lucid64 cflinuxfs2
        privileged: true
  - name: nodejs-buildpack-CF-LTS-master
    serial: true
    serial_groups: [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: buildpack
          passed: [ "detect new NodeJS buildpack and upload artifacts" ]
          resource: nodejs-buildpack-master
          trigger: true
        - get: pivotal-buildpacks
          resource: nodejs-pivotal-buildpack
          passed: [ "detect new NodeJS buildpack and upload artifacts" ]
          trigger: true
        - get: pivotal-buildpacks-cached
          resource: nodejs-pivotal-buildpack-cached
          passed: [ "detect new NodeJS buildpack and upload artifacts" ]
          trigger: true
      - task: rspec
        file: buildpacks-ci/tasks/test-buildpack-for-release.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-7
            STACKS: lucid64
        privileged: true
  - name: nodejs-buildpack-release
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: pivotal-buildpacks-cached
          resource: nodejs-pivotal-buildpack-cached
          passed: [ "nodejs-buildpack-CF-LTS-master", "nodejs-buildpack-CF-edge-master" ]
          trigger: true
        - get: buildpack
          passed: [ "nodejs-buildpack-CF-LTS-master", "nodejs-buildpack-CF-edge-master" ]
          resource: nodejs-buildpack-master
          trigger: true
      - task: check tag not already added
        file: buildpacks-ci/tasks/check-tag-not-already-added.yml
      - put: nodejs-buildpack-master
        params:
          repository: buildpack
          tag: buildpack/VERSION
          tag_prefix: v
  - name: nodejs buildpack to github
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: nodejs-pivotal-buildpack-cached
          passed: [ nodejs-buildpack-release ]
        - get: buildpack
          resource: nodejs-buildpack-master
          passed: [ nodejs-buildpack-release ]
      - task: upload to github
        file: buildpacks-ci/tasks/upload-to-github.yml
        config:
          params:
            GITHUB_ORG: cloudfoundry
            GITHUB_TOKEN: {{buildpacks-github-token}}
  - name: nodejs buildpack to cf-release
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: nodejs-pivotal-buildpack-cached
          passed: [ nodejs-buildpack-release ]
        - get: buildpack
          resource: nodejs-buildpack-master
          passed: [ nodejs-buildpack-release ]
        - get: cf-release
      - task: upload to cf-release
        file: buildpacks-ci/tasks/upload-to-cf-release.yml
        config:
          params:
            ACCESS_KEY_ID: {{blobstore-access-key}}
            SECRET_ACCESS_KEY: {{blobstore-secret-key}}
            GITHUB_USER: {{github-username}}
            GITHUB_PASSWORD: {{github-password}}
        privileged: true
  - name: nodejs buildpack to pivnet
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: nodejs-pivotal-buildpack-cached
          passed: [ nodejs-buildpack-release ]
        - get: buildpack
          resource: nodejs-buildpack-master
          passed: [ nodejs-buildpack-release ]
      - task: upload to pivnet
        file: buildpacks-ci/tasks/upload-to-pivnet.yml
        config:
          params:
            AWS_ACCESS_KEY_ID: {{pivnet-access-key}}
            AWS_SECRET_ACCESS_KEY: {{pivnet-secret-key}}
            PIVNET_S3_BUCKET: pivnet-acceptance
            PIVNET_ADDRESS: https://network.pivotal.io/
            PIVNET_APIKEY: {{pivnet-apikey}}
            PIVNET_PRODUCT_NAME: NodeJS Buildpack (offline)
        privileged: true
  - name: detect new Python buildpack and upload artifacts
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: buildpack
          resource: python-buildpack-master
          trigger: true
      - task: detect and upload
        file: buildpacks-ci/tasks/detect-and-upload.yml
        privileged: true
      - put: python-pivotal-buildpack
        params:
          from: buildpack/python_buildpack-v(.*).zip
          to: /experimental-buildpacks/python/
      - put: python-pivotal-buildpack-cached
        params:
          from: buildpack/python_buildpack-cached-v(.*).zip
          to: /experimental-buildpacks/python/
  - name: python-buildpack-CF-edge-master
    serial: true
    serial_groups: [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: buildpack
          passed: [ "detect new Python buildpack and upload artifacts" ]
          resource: python-buildpack-master
          trigger: true
        - get: pivotal-buildpacks
          resource: python-pivotal-buildpack
          passed: [ "detect new Python buildpack and upload artifacts" ]
          trigger: true
        - get: pivotal-buildpacks-cached
          resource: python-pivotal-buildpack-cached
          passed: [ "detect new Python buildpack and upload artifacts" ]
          trigger: true
      - task: rspec
        file: buildpacks-ci/tasks/test-buildpack-for-release.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-8
            STACKS: lucid64 cflinuxfs2
        privileged: true
  - name: python-buildpack-CF-LTS-master
    serial: true
    serial_groups: [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: buildpack
          passed: [ "detect new Python buildpack and upload artifacts" ]
          resource: python-buildpack-master
          trigger: true
        - get: pivotal-buildpacks
          resource: python-pivotal-buildpack
          passed: [ "detect new Python buildpack and upload artifacts" ]
          trigger: true
        - get: pivotal-buildpacks-cached
          resource: python-pivotal-buildpack-cached
          passed: [ "detect new Python buildpack and upload artifacts" ]
          trigger: true
      - task: rspec
        file: buildpacks-ci/tasks/test-buildpack-for-release.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-7
            STACKS: lucid64
        privileged: true
  - name: python-buildpack-release
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: pivotal-buildpacks-cached
          resource: python-pivotal-buildpack-cached
          passed: [ "python-buildpack-CF-LTS-master", "python-buildpack-CF-edge-master" ]
          trigger: true
        - get: buildpack
          passed: [ "python-buildpack-CF-LTS-master", "python-buildpack-CF-edge-master" ]
          resource: python-buildpack-master
          trigger: true
      - task: check tag not already added
        file: buildpacks-ci/tasks/check-tag-not-already-added.yml
      - put: python-buildpack-master
        params:
          repository: buildpack
          tag: buildpack/VERSION
          tag_prefix: v
  - name: python buildpack to github
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: python-pivotal-buildpack-cached
          passed: [ python-buildpack-release ]
        - get: buildpack
          resource: python-buildpack-master
          passed: [ python-buildpack-release ]
      - task: upload to github
        file: buildpacks-ci/tasks/upload-to-github.yml
        config:
          params:
            GITHUB_ORG: cloudfoundry
            GITHUB_TOKEN: {{buildpacks-github-token}}
  - name: python buildpack to cf-release
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: python-pivotal-buildpack-cached
          passed: [ python-buildpack-release ]
        - get: buildpack
          resource: python-buildpack-master
          passed: [ python-buildpack-release ]
        - get: cf-release
      - task: upload to cf-release
        file: buildpacks-ci/tasks/upload-to-cf-release.yml
        config:
          params:
            ACCESS_KEY_ID: {{blobstore-access-key}}
            SECRET_ACCESS_KEY: {{blobstore-secret-key}}
            GITHUB_USER: {{github-username}}
            GITHUB_PASSWORD: {{github-password}}
        privileged: true
  - name: python buildpack to pivnet
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: python-pivotal-buildpack-cached
          passed: [ python-buildpack-release ]
        - get: buildpack
          resource: python-buildpack-master
          passed: [ python-buildpack-release ]
      - task: upload to pivnet
        file: buildpacks-ci/tasks/upload-to-pivnet.yml
        config:
          params:
            AWS_ACCESS_KEY_ID: {{pivnet-access-key}}
            AWS_SECRET_ACCESS_KEY: {{pivnet-secret-key}}
            PIVNET_S3_BUCKET: pivnet-acceptance
            PIVNET_ADDRESS: https://network.pivotal.io/
            PIVNET_APIKEY: {{pivnet-apikey}}
            PIVNET_PRODUCT_NAME: Python Buildpack (offline)
        privileged: true
  - name: detect new Go buildpack and upload artifacts
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: buildpack
          resource: go-buildpack-master
          trigger: true
      - task: detect and upload
        file: buildpacks-ci/tasks/detect-and-upload.yml
        privileged: true
      - put: go-pivotal-buildpack
        params:
          from: buildpack/go_buildpack-v(.*).zip
          to: /experimental-buildpacks/go/
      - put: go-pivotal-buildpack-cached
        params:
          from: buildpack/go_buildpack-cached-v(.*).zip
          to: /experimental-buildpacks/go/
  - name: go-buildpack-CF-edge-master
    serial: true
    serial_groups: [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: buildpack
          passed: [ "detect new Go buildpack and upload artifacts" ]
          resource: go-buildpack-master
          trigger: true
        - get: pivotal-buildpacks
          resource: go-pivotal-buildpack
          passed: [ "detect new Go buildpack and upload artifacts" ]
          trigger: true
        - get: pivotal-buildpacks-cached
          resource: go-pivotal-buildpack-cached
          passed: [ "detect new Go buildpack and upload artifacts" ]
          trigger: true
      - task: rspec
        file: buildpacks-ci/tasks/test-buildpack-for-release.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-8
            STACKS: lucid64 cflinuxfs2
        privileged: true
  - name: go-buildpack-CF-LTS-master
    serial: true
    serial_groups: [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: buildpack
          passed: [ "detect new Go buildpack and upload artifacts" ]
          resource: go-buildpack-master
          trigger: true
        - get: pivotal-buildpacks
          resource: go-pivotal-buildpack
          passed: [ "detect new Go buildpack and upload artifacts" ]
          trigger: true
        - get: pivotal-buildpacks-cached
          resource: go-pivotal-buildpack-cached
          passed: [ "detect new Go buildpack and upload artifacts" ]
          trigger: true
      - task: rspec
        file: buildpacks-ci/tasks/test-buildpack-for-release.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-7
            STACKS: lucid64
        privileged: true
  - name: go-buildpack-release
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: pivotal-buildpacks-cached
          resource: go-pivotal-buildpack-cached
          passed: [ "go-buildpack-CF-LTS-master", "go-buildpack-CF-edge-master" ]
          trigger: true
        - get: buildpack
          passed: [ "go-buildpack-CF-LTS-master", "go-buildpack-CF-edge-master" ]
          resource: go-buildpack-master
          trigger: true
      - task: check tag not already added
        file: buildpacks-ci/tasks/check-tag-not-already-added.yml
      - put: go-buildpack-master
        params:
          repository: buildpack
          tag: buildpack/VERSION
          tag_prefix: v
  - name: go buildpack to github
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: go-pivotal-buildpack-cached
          passed: [ go-buildpack-release ]
        - get: buildpack
          resource: go-buildpack-master
          passed: [ go-buildpack-release ]
      - task: upload to github
        file: buildpacks-ci/tasks/upload-to-github.yml
        config:
          params:
            GITHUB_ORG: cloudfoundry
            GITHUB_TOKEN: {{buildpacks-github-token}}
  - name: go buildpack to cf-release
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: go-pivotal-buildpack-cached
          passed: [ go-buildpack-release ]
        - get: buildpack
          resource: go-buildpack-master
          passed: [ go-buildpack-release ]
        - get: cf-release
      - task: upload to cf-release
        file: buildpacks-ci/tasks/upload-to-cf-release.yml
        config:
          params:
            ACCESS_KEY_ID: {{blobstore-access-key}}
            SECRET_ACCESS_KEY: {{blobstore-secret-key}}
            GITHUB_USER: {{github-username}}
            GITHUB_PASSWORD: {{github-password}}
        privileged: true
  - name: go buildpack to pivnet
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: go-pivotal-buildpack-cached
          passed: [ go-buildpack-release ]
        - get: buildpack
          resource: go-buildpack-master
          passed: [ go-buildpack-release ]
      - task: upload to pivnet
        file: buildpacks-ci/tasks/upload-to-pivnet.yml
        config:
          params:
            AWS_ACCESS_KEY_ID: {{pivnet-access-key}}
            AWS_SECRET_ACCESS_KEY: {{pivnet-secret-key}}
            PIVNET_S3_BUCKET: pivnet-acceptance
            PIVNET_ADDRESS: https://network.pivotal.io/
            PIVNET_APIKEY: {{pivnet-apikey}}
            PIVNET_PRODUCT_NAME: Go Buildpack (offline)
        privileged: true
  - name: detect new PHP buildpack and upload artifacts
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: buildpack
          resource: php-buildpack-master
          trigger: true
      - task: detect and upload
        file: buildpacks-ci/tasks/detect-and-upload.yml
        privileged: true
      - put: php-pivotal-buildpack
        params:
          from: buildpack/php_buildpack-v(.*).zip
          to: /experimental-buildpacks/php/
      - put: php-pivotal-buildpack-cached
        params:
          from: buildpack/php_buildpack-cached-v(.*).zip
          to: /experimental-buildpacks/php/
  - name: php-buildpack-CF-edge-master
    serial: true
    serial_groups: [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: buildpack
          passed: [ "detect new PHP buildpack and upload artifacts" ]
          resource: php-buildpack-master
          trigger: true
        - get: pivotal-buildpacks
          resource: php-pivotal-buildpack
          passed: [ "detect new PHP buildpack and upload artifacts" ]
          trigger: true
        - get: pivotal-buildpacks-cached
          resource: php-pivotal-buildpack-cached
          passed: [ "detect new PHP buildpack and upload artifacts" ]
          trigger: true
      - task: rspec
        file: buildpacks-ci/tasks/test-buildpack-for-release.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-8
            STACKS: lucid64 cflinuxfs2
            COMPOSER_GITHUB_OAUTH_TOKEN: {{composer-github-oauth-token}}
        privileged: true
  - name: php-buildpack-CF-LTS-master
    serial: true
    serial_groups: [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: buildpack
          passed: [ "detect new PHP buildpack and upload artifacts" ]
          resource: php-buildpack-master
          trigger: true
        - get: pivotal-buildpacks
          resource: php-pivotal-buildpack
          passed: [ "detect new PHP buildpack and upload artifacts" ]
          trigger: true
        - get: pivotal-buildpacks-cached
          resource: php-pivotal-buildpack-cached
          passed: [ "detect new PHP buildpack and upload artifacts" ]
          trigger: true
      - task: rspec
        file: buildpacks-ci/tasks/test-buildpack-for-release.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-7
            STACKS: lucid64
            COMPOSER_GITHUB_OAUTH_TOKEN: {{composer-github-oauth-token}}
        privileged: true
  - name: php-buildpack-release
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: pivotal-buildpacks-cached
          resource: php-pivotal-buildpack-cached
          passed: [ "php-buildpack-CF-LTS-master", "php-buildpack-CF-edge-master" ]
          trigger: true
        - get: buildpack
          passed: [ "php-buildpack-CF-LTS-master", "php-buildpack-CF-edge-master" ]
          resource: php-buildpack-master
          trigger: true
      - task: check tag not already added
        file: buildpacks-ci/tasks/check-tag-not-already-added.yml
      - put: php-buildpack-master
        params:
          repository: buildpack
          tag: buildpack/VERSION
          tag_prefix: v
  - name: php buildpack to github
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: php-pivotal-buildpack-cached
          passed: [ php-buildpack-release ]
        - get: buildpack
          resource: php-buildpack-master
          passed: [ php-buildpack-release ]
      - task: upload to github
        file: buildpacks-ci/tasks/upload-to-github.yml
        config:
          params:
            GITHUB_ORG: cloudfoundry
            GITHUB_TOKEN: {{buildpacks-github-token}}
  - name: php buildpack to cf-release
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: php-pivotal-buildpack-cached
          passed: [ php-buildpack-release ]
        - get: buildpack
          resource: php-buildpack-master
          passed: [ php-buildpack-release ]
        - get: cf-release
      - task: upload to cf-release
        file: buildpacks-ci/tasks/upload-to-cf-release.yml
        config:
          params:
            ACCESS_KEY_ID: {{blobstore-access-key}}
            SECRET_ACCESS_KEY: {{blobstore-secret-key}}
            GITHUB_USER: {{github-username}}
            GITHUB_PASSWORD: {{github-password}}
        privileged: true
  - name: php buildpack to pivnet
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: php-pivotal-buildpack-cached
          passed: [ php-buildpack-release ]
        - get: buildpack
          resource: php-buildpack-master
          passed: [ php-buildpack-release ]
      - task: upload to pivnet
        file: buildpacks-ci/tasks/upload-to-pivnet.yml
        config:
          params:
            AWS_ACCESS_KEY_ID: {{pivnet-access-key}}
            AWS_SECRET_ACCESS_KEY: {{pivnet-secret-key}}
            PIVNET_S3_BUCKET: pivnet-acceptance
            PIVNET_ADDRESS: https://network.pivotal.io/
            PIVNET_APIKEY: {{pivnet-apikey}}
            PIVNET_PRODUCT_NAME: PHP Buildpack (offline)
        privileged: true
  - name: detect new Staticfile buildpack and upload artifacts
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: buildpack
          resource: staticfile-buildpack-master
          trigger: true
      - task: detect and upload
        file: buildpacks-ci/tasks/detect-and-upload.yml
        privileged: true
      - put: staticfile-pivotal-buildpack
        params:
          from: buildpack/staticfile_buildpack-v(.*).zip
          to: /experimental-buildpacks/staticfile/
      - put: staticfile-pivotal-buildpack-cached
        params:
          from: buildpack/staticfile_buildpack-cached-v(.*).zip
          to: /experimental-buildpacks/staticfile/
  - name: staticfile-buildpack-CF-edge-master
    serial: true
    serial_groups: [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: buildpack
          passed: [ "detect new Staticfile buildpack and upload artifacts" ]
          resource: staticfile-buildpack-master
          trigger: true
        - get: pivotal-buildpacks
          resource: staticfile-pivotal-buildpack
          passed: [ "detect new Staticfile buildpack and upload artifacts" ]
          trigger: true
        - get: pivotal-buildpacks-cached
          resource: staticfile-pivotal-buildpack-cached
          passed: [ "detect new Staticfile buildpack and upload artifacts" ]
          trigger: true
      - task: rspec
        file: buildpacks-ci/tasks/test-buildpack-for-release.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-8
            STACKS: lucid64 cflinuxfs2
        privileged: true
  - name: staticfile-buildpack-CF-LTS-master
    serial: true
    serial_groups: [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: buildpack
          passed: [ "detect new Staticfile buildpack and upload artifacts" ]
          resource: staticfile-buildpack-master
          trigger: true
        - get: pivotal-buildpacks
          resource: staticfile-pivotal-buildpack
          passed: [ "detect new Staticfile buildpack and upload artifacts" ]
          trigger: true
        - get: pivotal-buildpacks-cached
          resource: staticfile-pivotal-buildpack-cached
          passed: [ "detect new Staticfile buildpack and upload artifacts" ]
          trigger: true
      - task: rspec
        file: buildpacks-ci/tasks/test-buildpack-for-release.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-7
            STACKS: lucid64
        privileged: true
  - name: staticfile-buildpack-release
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: pivotal-buildpacks-cached
          resource: staticfile-pivotal-buildpack-cached
          passed: [ "staticfile-buildpack-CF-LTS-master", "staticfile-buildpack-CF-edge-master" ]
          trigger: true
        - get: buildpack
          passed: [ "staticfile-buildpack-CF-LTS-master", "staticfile-buildpack-CF-edge-master" ]
          resource: staticfile-buildpack-master
          trigger: true
      - task: check tag not already added
        file: buildpacks-ci/tasks/check-tag-not-already-added.yml
      - put: staticfile-buildpack-master
        params:
          repository: buildpack
          tag: buildpack/VERSION
          tag_prefix: v
  - name: staticfile buildpack to github
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: staticfile-pivotal-buildpack-cached
          passed: [ staticfile-buildpack-release ]
        - get: buildpack
          resource: staticfile-buildpack-master
          passed: [ staticfile-buildpack-release ]
      - task: upload to github
        file: buildpacks-ci/tasks/upload-to-github.yml
        config:
          params:
            GITHUB_ORG: cloudfoundry
            GITHUB_TOKEN: {{buildpacks-github-token}}
  - name: staticfile buildpack to cf-release
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: staticfile-pivotal-buildpack-cached
          passed: [ staticfile-buildpack-release ]
        - get: buildpack
          resource: staticfile-buildpack-master
          passed: [ staticfile-buildpack-release ]
        - get: cf-release
      - task: upload to cf-release
        file: buildpacks-ci/tasks/upload-to-cf-release.yml
        config:
          params:
            ACCESS_KEY_ID: {{blobstore-access-key}}
            SECRET_ACCESS_KEY: {{blobstore-secret-key}}
            GITHUB_USER: {{github-username}}
            GITHUB_PASSWORD: {{github-password}}
        privileged: true
  - name: staticfile buildpack to pivnet
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: staticfile-pivotal-buildpack-cached
          passed: [ staticfile-buildpack-release ]
        - get: buildpack
          resource: staticfile-buildpack-master
          passed: [ staticfile-buildpack-release ]
      - task: upload to pivnet
        file: buildpacks-ci/tasks/upload-to-pivnet.yml
        config:
          params:
            AWS_ACCESS_KEY_ID: {{pivnet-access-key}}
            AWS_SECRET_ACCESS_KEY: {{pivnet-secret-key}}
            PIVNET_S3_BUCKET: pivnet-acceptance
            PIVNET_ADDRESS: https://network.pivotal.io/
            PIVNET_APIKEY: {{pivnet-apikey}}
            PIVNET_PRODUCT_NAME: Staticfile Buildpack (offline)
        privileged: true
  - name: detect new Binary buildpack and upload artifacts
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: buildpack
          resource: binary-buildpack-master
          trigger: true
      - task: detect and upload
        file: buildpacks-ci/tasks/detect-and-upload.yml
        privileged: true
      - put: binary-pivotal-buildpack
        params:
          from: buildpack/binary_buildpack-v(.*).zip
          to: /experimental-buildpacks/binary/
      - put: binary-pivotal-buildpack-cached
        params:
          from: buildpack/binary_buildpack-cached-v(.*).zip
          to: /experimental-buildpacks/binary/
  - name: binary-buildpack-CF-edge-master
    serial: true
    serial_groups: [bp-ci-8]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: buildpack
          passed: [ "detect new Binary buildpack and upload artifacts" ]
          resource: binary-buildpack-master
          trigger: true
        - get: pivotal-buildpacks
          resource: binary-pivotal-buildpack
          passed: [ "detect new Binary buildpack and upload artifacts" ]
          trigger: true
        - get: pivotal-buildpacks-cached
          resource: binary-pivotal-buildpack-cached
          passed: [ "detect new Binary buildpack and upload artifacts" ]
          trigger: true
      - task: rspec
        file: buildpacks-ci/tasks/test-buildpack-for-release.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-8
            STACKS: lucid64 cflinuxfs2
        privileged: true
  - name: binary-buildpack-CF-LTS-master
    serial: true
    serial_groups: [bp-ci-7]
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: deployments-buildpacks
        - get: buildpack
          passed: [ "detect new Binary buildpack and upload artifacts" ]
          resource: binary-buildpack-master
          trigger: true
        - get: pivotal-buildpacks
          resource: binary-pivotal-buildpack
          passed: [ "detect new Binary buildpack and upload artifacts" ]
          trigger: true
        - get: pivotal-buildpacks-cached
          resource: binary-pivotal-buildpack-cached
          passed: [ "detect new Binary buildpack and upload artifacts" ]
          trigger: true
      - task: rspec
        file: buildpacks-ci/tasks/test-buildpack-for-release.yml
        config:
          params:
            DEPLOYMENT_NAME: bp-ci-7
            STACKS: lucid64
        privileged: true
  - name: binary-buildpack-release
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: pivotal-buildpacks-cached
          resource: binary-pivotal-buildpack-cached
          passed: [ "binary-buildpack-CF-LTS-master", "binary-buildpack-CF-edge-master" ]
          trigger: true
        - get: buildpack
          passed: [ "binary-buildpack-CF-LTS-master", "binary-buildpack-CF-edge-master" ]
          resource: binary-buildpack-master
          trigger: true
      - task: check tag not already added
        file: buildpacks-ci/tasks/check-tag-not-already-added.yml
      - put: binary-buildpack-master
        params:
          repository: buildpack
          tag: buildpack/VERSION
          tag_prefix: v
  - name: binary buildpack to github
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: binary-pivotal-buildpack-cached
          passed: [ binary-buildpack-release ]
        - get: buildpack
          resource: binary-buildpack-master
          passed: [ binary-buildpack-release ]
      - task: upload to github
        file: buildpacks-ci/tasks/upload-to-github.yml
        config:
          params:
            GITHUB_ORG: cloudfoundry
            GITHUB_TOKEN: {{buildpacks-github-token}}
  - name: binary buildpack to cf-release
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: binary-pivotal-buildpack-cached
          passed: [ binary-buildpack-release ]
        - get: buildpack
          resource: binary-buildpack-master
          passed: [ binary-buildpack-release ]
        - get: cf-release
      - task: upload to cf-release
        file: buildpacks-ci/tasks/upload-to-cf-release.yml
        config:
          params:
            ACCESS_KEY_ID: {{blobstore-access-key}}
            SECRET_ACCESS_KEY: {{blobstore-secret-key}}
            GITHUB_USER: {{github-username}}
            GITHUB_PASSWORD: {{github-password}}
        privileged: true
  - name: binary buildpack to pivnet
    serial: true
    plan:
      - aggregate:
        - get: buildpacks-ci
        - get: ci-tools
        - get: pivotal-buildpacks-cached
          resource: binary-pivotal-buildpack-cached
          passed: [ binary-buildpack-release ]
        - get: buildpack
          resource: binary-buildpack-master
          passed: [ binary-buildpack-release ]
      - task: upload to pivnet
        file: buildpacks-ci/tasks/upload-to-pivnet.yml
        config:
          params:
            AWS_ACCESS_KEY_ID: {{pivnet-access-key}}
            AWS_SECRET_ACCESS_KEY: {{pivnet-secret-key}}
            PIVNET_S3_BUCKET: pivnet-acceptance
            PIVNET_ADDRESS: https://network.pivotal.io/
            PIVNET_APIKEY: {{pivnet-apikey}}
            PIVNET_PRODUCT_NAME: Binary Buildpack (offline)
        privileged: true
